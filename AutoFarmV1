_G.ToggleAutoFarm = _G.ToggleAutoFarm or false

task.spawn(function()
	while _G.ToggleAutoFarm do
		for _, enemyModel in ipairs(workspace:WaitForChild("Enemys"):GetChildren()) do
			local enemyGuid = enemyModel:GetAttribute("EnemyGuid")
			local enemyPos = enemyModel:FindFirstChild("HumanoidRootPart") and enemyModel.HumanoidRootPart.Position

			if enemyGuid and enemyPos then
				game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("ClickEnemy"):InvokeServer({
					enemyGuid = enemyGuid,
					enemyPos = enemyPos
				})
			end

			if enemyGuid then
				game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("PlayerClickAttackSkill"):FireServer({
					attackEnemyGUID = enemyGuid
				})
			end
		end

		game:GetService("RunService").Heartbeat:Wait()
	end
end)
