if getgenv().AutoFarmV2Running then
    getgenv().AutoFarmV2Running = false
    return
end

getgenv().AutoFarmV2Running = true

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remotes = ReplicatedStorage:WaitForChild("Remotes")
local PlayerClickAttackSkill = Remotes:WaitForChild("PlayerClickAttackSkill")

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Settings
local teleportDistance = 5
local attackInterval = 0.01

-- Loop to teleport and attack enemies
task.spawn(function()
    while getgenv().AutoFarmV2Running and task.wait(attackInterval) do
        local enemies = workspace:FindFirstChild("Enemys")
        if enemies then
            for _, enemy in pairs(enemies:GetChildren()) do
                if enemy and enemy:IsA("Model") and not string.find(enemy.Name, "Roger") then
                    local enemyRootPart = enemy:FindFirstChild("HumanoidRootPart")
                    if enemyRootPart then
                        local newPosition = humanoidRootPart.Position + humanoidRootPart.CFrame.LookVector * teleportDistance
                        enemyRootPart.CFrame = CFrame.new(newPosition)

                        local enemyGUID = enemy:GetAttribute("EnemyGuid")
                        if enemyGUID then
                            local args = {
                                [1] = {
                                    ["attackEnemyGUID"] = enemyGUID
                                }
                            }
                            PlayerClickAttackSkill:FireServer(unpack(args))
                        end
                    end
                end
            end
        end
    end
end)
